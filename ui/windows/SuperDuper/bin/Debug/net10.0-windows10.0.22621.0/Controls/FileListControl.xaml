<UserControl
    x:Class="SuperDuper.Controls.FileListControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:models="using:SuperDuper.Models">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- Mode toggle + sort -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="8" Padding="8,4"
                    Background="{ThemeResource ControlAltFillColorSecondaryBrush}">
            <RadioButton Content="All Files"
                         IsChecked="True"
                         GroupName="FileMode"
                         />
            <RadioButton Content="Duplicates Only"
                         GroupName="FileMode"
                         />
            <ComboBox x:Name="SortCombo"
                      Header="Sort"
                      SelectedIndex="0"
                      MinWidth="120"
                      >
                <ComboBoxItem Content="Name" Tag="file_name" />
                <ComboBoxItem Content="Size" Tag="file_size" />
                <ComboBoxItem Content="Date" Tag="last_modified" />
            </ComboBox>
        </StackPanel>

        <!-- File list -->
        <ScrollViewer Grid.Row="1">
            <ItemsRepeater x:Name="FileRepeater"
                           ItemsSource="{Binding Files, Mode=OneTime}">
                <ItemsRepeater.Layout>
                    <StackLayout Spacing="1" />
                </ItemsRepeater.Layout>
                <ItemsRepeater.ItemTemplate>
                    <DataTemplate>
                        <Grid Height="32" Padding="8,0" ColumnSpacing="8"
                              Background="{ThemeResource ControlAltFillColorDefaultBrush}"
                              Opacity="{Binding IsDuplicateOpacity, Mode=OneTime}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="20" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="70" />
                                <ColumnDefinition Width="90" />
                                <ColumnDefinition Width="20" />
                            </Grid.ColumnDefinitions>

                            <!-- File type icon -->
                            <FontIcon Grid.Column="0" Glyph="{Binding FileTypeGlyph, Mode=OneTime}"
                                      FontSize="14" VerticalAlignment="Center" />

                            <!-- Filename -->
                            <TextBlock Grid.Column="1" Text="{Binding FileName, Mode=OneTime}"
                                       TextTrimming="CharacterEllipsis"
                                       VerticalAlignment="Center" />

                            <!-- Duplicate count badge -->
                            <Border Grid.Column="2"
                                    Visibility="{Binding IsDuplicateVisibility, Mode=OneTime}"
                                    Background="{ThemeResource AccentFillColorDefaultBrush}"
                                    CornerRadius="8" Padding="5,1"
                                    VerticalAlignment="Center">
                                <TextBlock Foreground="White" FontSize="10">
                                    <Run Text="x" /><Run Text="{Binding CopyCount, Mode=OneTime}" />
                                </TextBlock>
                            </Border>

                            <!-- File size -->
                            <TextBlock Grid.Column="3" Text="{Binding FormattedSize, Mode=OneTime}"
                                       TextAlignment="Right"
                                       Style="{StaticResource CaptionTextBlockStyle}"
                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                       VerticalAlignment="Center" />

                            <!-- Date modified -->
                            <TextBlock Grid.Column="4" Text="{Binding FormattedDate, Mode=OneTime}"
                                       Style="{StaticResource CaptionTextBlockStyle}"
                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                       VerticalAlignment="Center" />

                            <!-- Review status icon -->
                            <FontIcon Grid.Column="5" Glyph="{Binding ReviewStatusGlyph, Mode=OneTime}"
                                      FontSize="12" VerticalAlignment="Center" />
                        </Grid>
                    </DataTemplate>
                </ItemsRepeater.ItemTemplate>
            </ItemsRepeater>
        </ScrollViewer>
    </Grid>
</UserControl>
