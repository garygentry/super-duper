<Window
    x:Class="SuperDuper.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:SuperDuper"
    Title="Super Duper">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="36" />
        </Grid.RowDefinitions>

        <!-- Row 0: NavigationView with integrated title bar and content frame -->
        <NavigationView
            x:Name="NavView"
            Grid.Row="0"
            IsBackButtonVisible="Collapsed"
            IsSettingsVisible="True"
            PaneDisplayMode="Left"
            IsTitleBarAutoPaddingEnabled="False"
            SelectionChanged="NavView_SelectionChanged"
            AutomationProperties.Name="Main navigation">

            <NavigationView.PaneHeader>
                <Grid x:Name="AppTitleBar" Height="48" Background="Transparent">
                    <TextBlock Text="Super Duper"
                               Style="{StaticResource BodyStrongTextBlockStyle}"
                               Margin="12,0,0,0"
                               VerticalAlignment="Center" />
                </Grid>
            </NavigationView.PaneHeader>

            <NavigationView.MenuItems>
                <NavigationViewItem Content="Dashboard"
                                    Tag="dashboard"
                                    Icon="Home"
                                    AutomationProperties.Name="Dashboard — scan overview" />
                <NavigationViewItem Content="Explorer"
                                    Tag="explorer"
                                    Icon="BrowsePhotos"
                                    AutomationProperties.Name="Explorer — browse and review duplicate files" />
                <NavigationViewItem Content="Groups"
                                    Tag="groups"
                                    Icon="Copy"
                                    AutomationProperties.Name="Groups — all duplicate groups" />
                <NavigationViewItem Content="Directories"
                                    Tag="directories"
                                    Icon="Folder"
                                    AutomationProperties.Name="Directories — similar directory pairs" />
            </NavigationView.MenuItems>

            <!-- Main content frame -->
            <Frame x:Name="ContentFrame" />
        </NavigationView>

        <!-- Row 1: Bottom status bar (36px) -->
        <Grid Grid.Row="1"
              Padding="16,0"
              Background="{ThemeResource NavigationViewExpandedPaneBackground}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <!-- Deletion queue summary -->
            <TextBlock Grid.Column="0"
                       x:Name="StatusBarText"
                       Text="{x:Bind ViewModel.DeletionQueueSummary, Mode=OneWay}"
                       VerticalAlignment="Center"
                       Style="{StaticResource CaptionTextBlockStyle}"
                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                       AutomationProperties.Name="Deletion queue status" />

            <!-- Undo/Redo buttons -->
            <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="4" VerticalAlignment="Center" Margin="0,0,8,0">
                <Button x:Name="UndoButton"
                        Command="{x:Bind ViewModel.UndoCommand}"
                        IsEnabled="{x:Bind ViewModel.CanUndo, Mode=OneWay}"
                        ToolTipService.ToolTip="{x:Bind ViewModel.UndoDescription, Mode=OneWay}"
                        Background="Transparent" BorderThickness="0" Padding="8,4"
                        AutomationProperties.Name="Undo last action">
                    <FontIcon Glyph="&#xE7A7;" FontSize="14" />
                </Button>
                <Button x:Name="RedoButton"
                        Command="{x:Bind ViewModel.RedoCommand}"
                        IsEnabled="{x:Bind ViewModel.CanRedo, Mode=OneWay}"
                        ToolTipService.ToolTip="{x:Bind ViewModel.RedoDescription, Mode=OneWay}"
                        Background="Transparent" BorderThickness="0" Padding="8,4"
                        AutomationProperties.Name="Redo last undone action">
                    <FontIcon Glyph="&#xE7A6;" FontSize="14" />
                </Button>
            </StackPanel>

            <!-- Review & Delete trigger -->
            <Button Grid.Column="2"
                    x:Name="ReviewDeleteButton"
                    Content="Review &amp; Delete →"
                    Style="{StaticResource AccentButtonStyle}"
                    Height="28"
                    FontSize="12"
                    IsEnabled="{x:Bind ViewModel.IsDeletionQueueNonEmpty, Mode=OneWay}"
                    Click="ReviewDeleteButton_Click"
                    AutomationProperties.Name="Open deletion review dialog"
                    VerticalAlignment="Center" />
        </Grid>

        <!-- Keyboard accelerators for global shortcuts -->
        <Grid.KeyboardAccelerators>
            <KeyboardAccelerator Key="Z" Modifiers="Control" Invoked="OnUndoAccelerator" />
            <KeyboardAccelerator Key="Y" Modifiers="Control" Invoked="OnRedoAccelerator" />
            <KeyboardAccelerator Key="Z" Modifiers="Control,Shift" Invoked="OnRedoAccelerator" />
            <KeyboardAccelerator Key="D" Modifiers="Control" Invoked="OnOpenDeletionDialogAccelerator" />
            <KeyboardAccelerator Key="F5" Invoked="OnRefreshAccelerator" />
        </Grid.KeyboardAccelerators>
    </Grid>
</Window>
