<!-- MainPage: NavigationView shell with page-based navigation -->
<Page
    x:Class="SuperDuper.Views.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:SuperDuper.Views">

    <NavigationView
        x:Name="NavView"
        IsBackButtonVisible="Collapsed"
        IsSettingsVisible="True"
        PaneDisplayMode="Left"
        SelectionChanged="NavView_SelectionChanged">

        <NavigationView.MenuItems>
            <NavigationViewItem Content="Dashboard" Icon="Home" Tag="dashboard" IsSelected="True" />
            <NavigationViewItem Content="Duplicate Groups" Icon="Copy" Tag="duplicates" />
            <NavigationViewItem Content="Directory Comparison" Icon="Folder" Tag="directories" />
            <NavigationViewItem Content="Deletion Review" Icon="Delete" Tag="deletion" />
        </NavigationView.MenuItems>

        <Grid>
            <!-- Dashboard (inline, shown by default) -->
            <Grid x:Name="DashboardContent" Padding="24">
                <StackPanel Spacing="16">
                    <TextBlock Text="Super Duper" Style="{StaticResource TitleTextBlockStyle}" />
                    <TextBlock Text="{x:Bind ViewModel.StatusMessage, Mode=OneWay}"
                               Style="{StaticResource SubtitleTextBlockStyle}" />

                    <Grid ColumnSpacing="16">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <Border Grid.Column="0" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                CornerRadius="8" Padding="16">
                            <StackPanel>
                                <TextBlock Text="Files Scanned" Style="{StaticResource CaptionTextBlockStyle}" />
                                <TextBlock Text="{x:Bind ViewModel.TotalFilesScanned, Mode=OneWay}"
                                           Style="{StaticResource HeaderTextBlockStyle}" />
                            </StackPanel>
                        </Border>

                        <Border Grid.Column="1" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                CornerRadius="8" Padding="16">
                            <StackPanel>
                                <TextBlock Text="Duplicate Groups" Style="{StaticResource CaptionTextBlockStyle}" />
                                <TextBlock Text="{x:Bind ViewModel.TotalDuplicateGroups, Mode=OneWay}"
                                           Style="{StaticResource HeaderTextBlockStyle}" />
                            </StackPanel>
                        </Border>

                        <Border Grid.Column="2" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                CornerRadius="8" Padding="16">
                            <StackPanel>
                                <TextBlock Text="Wasted Space" Style="{StaticResource CaptionTextBlockStyle}" />
                                <TextBlock Text="{x:Bind ViewModel.FormattedWastedBytes, Mode=OneWay}"
                                           Style="{StaticResource HeaderTextBlockStyle}" />
                            </StackPanel>
                        </Border>
                    </Grid>

                    <!-- Scan paths configuration -->
                    <TextBlock Text="Scan Paths" Style="{StaticResource BodyStrongTextBlockStyle}" />
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <TextBox x:Name="ScanPathInput"
                                 Text="{x:Bind ViewModel.NewScanPath, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                 PlaceholderText="Enter folder path to scan..."
                                 MinWidth="400" />
                        <Button Content="Add"
                                Command="{x:Bind ViewModel.AddScanPathCommand}" />
                    </StackPanel>

                    <ListView ItemsSource="{x:Bind ViewModel.ScanPaths}"
                              SelectionMode="None"
                              MaxHeight="150">
                        <ListView.ItemTemplate>
                            <DataTemplate x:DataType="x:String">
                                <Grid ColumnSpacing="8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="{x:Bind}"
                                               VerticalAlignment="Center" />
                                    <Button Grid.Column="1" Content="&#xE711;"
                                            FontFamily="{StaticResource SymbolThemeFontFamily}"
                                            Command="{Binding DataContext.ViewModel.RemoveScanPathCommand, ElementName=ScanPathInput}"
                                            CommandParameter="{x:Bind}"
                                            Background="Transparent" BorderThickness="0"
                                            Padding="4" />
                                </Grid>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>

                    <!-- Ignore patterns configuration -->
                    <TextBlock Text="Ignore Patterns" Style="{StaticResource BodyStrongTextBlockStyle}" />
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <TextBox Text="{x:Bind ViewModel.NewIgnorePattern, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                 PlaceholderText="e.g. **/node_modules/**"
                                 MinWidth="400" />
                        <Button Content="Add"
                                Command="{x:Bind ViewModel.AddIgnorePatternCommand}" />
                    </StackPanel>

                    <ListView ItemsSource="{x:Bind ViewModel.IgnorePatterns}"
                              SelectionMode="None"
                              MaxHeight="120">
                        <ListView.ItemTemplate>
                            <DataTemplate x:DataType="x:String">
                                <Grid ColumnSpacing="8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="{x:Bind}"
                                               VerticalAlignment="Center"
                                               FontFamily="Consolas" />
                                    <Button Grid.Column="1" Content="&#xE711;"
                                            FontFamily="{StaticResource SymbolThemeFontFamily}"
                                            Command="{Binding DataContext.ViewModel.RemoveIgnorePatternCommand, ElementName=ScanPathInput}"
                                            CommandParameter="{x:Bind}"
                                            Background="Transparent" BorderThickness="0"
                                            Padding="4" />
                                </Grid>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>

                    <StackPanel Orientation="Horizontal" Spacing="12">
                        <Button Content="Start Scan"
                                Command="{x:Bind ViewModel.StartScanCommand}"
                                IsEnabled="{x:Bind ViewModel.IsScanning, Mode=OneWay, Converter={StaticResource InvertBoolConverter}}"
                                Style="{StaticResource AccentButtonStyle}" />
                        <Button Content="Cancel"
                                Command="{x:Bind ViewModel.CancelScanCommand}"
                                Visibility="{x:Bind ViewModel.IsScanning, Mode=OneWay}" />
                        <ProgressRing IsActive="{x:Bind ViewModel.IsScanning, Mode=OneWay}"
                                      Visibility="{x:Bind ViewModel.IsScanning, Mode=OneWay}"
                                      Width="24" Height="24" />
                    </StackPanel>
                </StackPanel>
            </Grid>

            <!-- Frame for sub-pages (hidden by default) -->
            <Frame x:Name="SubPageFrame" Visibility="Collapsed" />
        </Grid>
    </NavigationView>
</Page>
