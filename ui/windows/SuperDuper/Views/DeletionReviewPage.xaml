<!-- DeletionReviewPage: Review and execute deletion plan -->
<Page
    x:Class="SuperDuper.Views.DeletionReviewPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:vm="using:SuperDuper.ViewModels">

    <Grid Padding="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Spacing="8" Margin="0,0,0,16">
            <TextBlock Text="Deletion Review" Style="{StaticResource TitleTextBlockStyle}" />
            <TextBlock Text="{x:Bind ViewModel.StatusMessage, Mode=OneWay}"
                       Style="{StaticResource SubtitleTextBlockStyle}" />
        </StackPanel>

        <!-- Summary cards -->
        <Grid Grid.Row="1" ColumnSpacing="16" Margin="0,0,0,16">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <Border Grid.Column="0" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    CornerRadius="8" Padding="16">
                <StackPanel>
                    <TextBlock Text="Files to Delete" Style="{StaticResource CaptionTextBlockStyle}" />
                    <TextBlock Text="{x:Bind ViewModel.FileCount, Mode=OneWay}"
                               Style="{StaticResource HeaderTextBlockStyle}" />
                </StackPanel>
            </Border>

            <Border Grid.Column="1" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    CornerRadius="8" Padding="16">
                <StackPanel>
                    <TextBlock Text="Space to Reclaim" Style="{StaticResource CaptionTextBlockStyle}" />
                    <TextBlock Text="{x:Bind ViewModel.FormattedTotalBytes, Mode=OneWay}"
                               Style="{StaticResource HeaderTextBlockStyle}" />
                </StackPanel>
            </Border>
        </Grid>

        <!-- Action buttons -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" Spacing="12" Margin="0,0,0,16">
            <Button Content="Auto-Mark Duplicates"
                    Command="{x:Bind ViewModel.AutoMarkCommand}" />
            <Button Content="Refresh"
                    Command="{x:Bind ViewModel.RefreshSummaryCommand}" />
            <Button x:Name="ExecuteButton"
                    Content="Execute Deletion"
                    Click="ExecuteButton_Click"
                    Style="{StaticResource AccentButtonStyle}" />
        </StackPanel>

        <!-- Marked files list -->
        <Grid Grid.Row="3">
            <ProgressRing IsActive="{x:Bind ViewModel.IsLoadingFiles, Mode=OneWay}"
                          Visibility="{x:Bind ViewModel.IsLoadingFiles, Mode=OneWay}"
                          HorizontalAlignment="Left" Width="24" Height="24" Margin="0,4,0,0" />

            <TextBlock Text="No files are marked for deletion. Use Auto-Mark or mark files from the Duplicates view."
                       Visibility="{x:Bind ViewModel.HasNoFiles, Mode=OneWay}"
                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                       TextWrapping="Wrap"
                       HorizontalAlignment="Center"
                       Margin="0,32,0,0" />

            <ListView ItemsSource="{x:Bind ViewModel.MarkedFiles}"
                      SelectionMode="None">
                <ListView.ItemContainerStyle>
                    <Style TargetType="ListViewItem">
                        <Setter Property="Padding" Value="0" />
                        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                    </Style>
                </ListView.ItemContainerStyle>
                <ListView.ItemTemplate>
                    <DataTemplate x:DataType="vm:MarkedFileViewModel">
                        <Border Margin="0,2" Padding="12,8" CornerRadius="6"
                                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}">
                            <Grid ColumnSpacing="12">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" Spacing="2">
                                    <TextBlock Text="{x:Bind FileName}"
                                               Style="{StaticResource BodyStrongTextBlockStyle}" />
                                    <TextBlock Text="{x:Bind DisplayPath}"
                                               Style="{StaticResource PathTextStyle}" />
                                </StackPanel>

                                <TextBlock Grid.Column="1" Text="{x:Bind FormattedSize}"
                                           VerticalAlignment="Center"
                                           Foreground="{ThemeResource TextFillColorSecondaryBrush}" />

                                <Button Grid.Column="2" Content="Unmark"
                                        Command="{x:Bind UnmarkCommand}"
                                        VerticalAlignment="Center"
                                        FontSize="12" Padding="10,4" />
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
        </Grid>
    </Grid>
</Page>
